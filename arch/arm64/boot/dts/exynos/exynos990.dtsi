// SPDX-License-Identifier: GPL-2.0-only
/*
 * Copyright (c) 2023, Igor Belwon <thenxguy0@gmail.com>
 */

#include <dt-bindings/interrupt-controller/arm-gic.h>

/ {
    #address-cells = <2>;
	#size-cells = <2>;
	interrupt-parent = <&interruptctl>;

    arm-pmu {
		compatible = "arm,cortex-a55-pmu";
		interrupts = <GIC_SPI 89 IRQ_TYPE_LEVEL_HIGH>,
			     <GIC_SPI 90 IRQ_TYPE_LEVEL_HIGH>,
			     <GIC_SPI 91 IRQ_TYPE_LEVEL_HIGH>,
			     <GIC_SPI 92 IRQ_TYPE_LEVEL_HIGH>,
			     <GIC_SPI 108 IRQ_TYPE_LEVEL_HIGH>,
			     <GIC_SPI 109 IRQ_TYPE_LEVEL_HIGH>,
			     <GIC_SPI 110 IRQ_TYPE_LEVEL_HIGH>,
			     <GIC_SPI 111 IRQ_TYPE_LEVEL_HIGH>;
		interrupt-affinity = <&cpu0>, <&cpu1>, <&cpu2>, <&cpu3>,
				     <&cpu4>, <&cpu5>;
	};

    cpus {
        #address-cells = <1>;
		#size-cells = <0>;

		cpu0: cpu@0 {
			device_type = "cpu";
			compatible = "arm,cortex-a55";
			reg = <0x0>;
			enable-method = "psci";
		};

		cpu1: cpu@1 {
			device_type = "cpu";
			compatible = "arm,cortex-a55";
			reg = <0x1>;
            enable-method = "psci";
		};

		cpu2: cpu@2 {
			device_type = "cpu";
			compatible = "arm,cortex-a55";
			reg = <0x2>;
			enable-method = "psci";
		};

		cpu3: cpu@3 {
			device_type = "cpu";
			compatible = "arm,cortex-a55";
			reg = <0x3>;
			enable-method = "psci";
		};

		cpu4: cpu@100 {
			device_type = "cpu";
			compatible = "arm,cortex-a76";
			reg = <0x4>;
            enable-method = "psci";
		};

		cpu5: cpu@101 {
			device_type = "cpu";
			compatible = "arm,cortex-a76";
			reg = <0x5>;
			enable-method = "psci";
		};

        /* This is the custom CPU side. Not currently in mainline tree. */
        /*
		cpu6: cpu@200 {
			device_type = "cpu";
			compatible = "arm,lion\0arm,armv8";
			reg = <0x00 0x100>;
			enable-method = "psci";
			cpu-idle-states = <0x13d>;
			sched-energy-data = <0x13e>;
			i-cache-size = <0x10000>;
			i-cache-line-size = <0x80>;
			i-cache-sets = <0x80>;
			d-cache-size = <0x10000>;
			d-cache-line-size = <0x40>;
			d-cache-sets = <0x100>;
			next-level-cache = <0x13f>;
			moce-factors = <0x140>;
			phandle = <0xbb>;
		};

		cpu7: cpu@201 {
			device_type = "cpu";
			compatible = "arm,lion\0arm,armv8";
			reg = <0x00 0x101>;
			enable-method = "psci";
			cpu-idle-states = <0x13d>;
			sched-energy-data = <0x13e>;
			i-cache-size = <0x10000>;
			i-cache-line-size = <0x80>;
			i-cache-sets = <0x80>;
			d-cache-size = <0x10000>;
			d-cache-line-size = <0x40>;
			d-cache-sets = <0x100>;
			next-level-cache = <0x13f>;
			moce-factors = <0x140>;
			phandle = <0xbc>;
		}; */

        cpu-map {
			cluster0 {
				core0 {
					cpu = <&cpu0>;
				};

				core1 {
					cpu = <&cpu1>;
				};

				core2 {
					cpu = <&cpu2>;
				};

				core3 {
					cpu = <&cpu3>;
				};
			};

			cluster1 {
				core0 {
					cpu = <&cpu4>;
				};

				core1 {
					cpu = <&cpu5>;
				};
			};

            /* Cluster 2 is the custom CPUs */
		};
    };


	psci {
		compatible = "arm,psci";
		method = "smc";
	};

	soc: soc {
		compatible = "simple-bus";
		#address-cells = <1>;
		#size-cells = <1>;
		ranges = <0 0 0 0xffffffff>;

			/* To be cleaned up... */
			interruptctl: interrupt-controller@10100000 {
				compatible = "arm,cortex-a15-gic";
				#interrupt-cells = <0x03>;
				interrupt-controller;
				reg = <0x00 0x10101000 0x1000 0x00 0x10102000 0x1000 0x00 0x10104000 0x2000 0x00 0x10106000 0x2000>;
				interrupts = <0x01 0x09 0xf04>;
		};
	};

	timer {
		compatible = "arm,armv8-timer";
		interrupts = <0x01 0x0d 0xff08 0x01 0x0e 0xff08 0x01 0x0b 0xff08 0x01 0x0a 0xff08>;
		clock-frequency = <26000000>;
	};
};